<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ ˆè®¡æ•°å™¨ä»£ç è¯¦è§£ - äº¤äº’å¼æ•™ç¨‹</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <style>
        * { scroll-behavior: smooth; }
        .code-line { transition: all 0.3s; cursor: pointer; }
        .code-line:hover { background: rgba(59, 130, 246, 0.2); }
        .code-line.active { background: rgba(59, 130, 246, 0.3); border-left: 3px solid #3b82f6; }
        .tooltip { opacity: 0; transition: opacity 0.3s; pointer-events: none; }
        .tooltip.show { opacity: 1; pointer-events: auto; }
        .flow-step { opacity: 0.3; transition: all 0.5s; }
        .flow-step.active { opacity: 1; transform: scale(1.05); }
        .concept-card { transition: all 0.3s; }
        .concept-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        pre[class*="language-"] { margin: 0; border-radius: 0.5rem; }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .arrow-animate { animation: arrowMove 1.5s ease-in-out infinite; }
        @keyframes arrowMove { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(10px); } }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- å¯¼èˆªæ  -->
    <nav class="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-sm shadow-sm z-50">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
            <span class="font-bold text-xl gradient-text">ğŸ“š å…¨æ ˆæ•™ç¨‹</span>
            <div class="hidden md:flex gap-6 text-sm">
                <a href="#overview" class="hover:text-blue-600 transition">æ¶æ„æ¦‚è§ˆ</a>
                <a href="#frontend" class="hover:text-blue-600 transition">å‰ç«¯ä»£ç </a>
                <a href="#backend" class="hover:text-blue-600 transition">åç«¯ä»£ç </a>
                <a href="#flow" class="hover:text-blue-600 transition">æ•°æ®æµåŠ¨</a>
                <a href="#concepts" class="hover:text-blue-600 transition">æ ¸å¿ƒæ¦‚å¿µ</a>
                <a href="#quiz" class="hover:text-blue-600 transition">æµ‹éªŒ</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-600 via-purple-600 to-pink-500 text-white pt-16">
        <div class="text-center px-4">
            <h1 class="text-5xl md:text-7xl font-bold mb-6">ğŸ”§ å…¨æ ˆè®¡æ•°å™¨</h1>
            <p class="text-xl md:text-2xl mb-4 opacity-90">ä»é›¶ç†è§£ç°ä»£ Web å…¨æ ˆå¼€å‘</p>
            <p class="text-lg opacity-75 max-w-2xl mx-auto mb-8">
                è¿™ä¸ªæ•™ç¨‹å°†å¸¦ä½ é€è¡Œå‰–æä¸€ä¸ªå®Œæ•´çš„å‰åç«¯åº”ç”¨ï¼Œæ¶µç›– CORSã€è¾¹ç¼˜è®¡ç®—ã€SQL é˜²æ³¨å…¥ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹
            </p>
            <div class="flex flex-wrap justify-center gap-4 mb-12">
                <span class="px-4 py-2 bg-white/20 rounded-full text-sm">HTML/CSS/JS</span>
                <span class="px-4 py-2 bg-white/20 rounded-full text-sm">Cloudflare Workers</span>
                <span class="px-4 py-2 bg-white/20 rounded-full text-sm">D1 Database</span>
                <span class="px-4 py-2 bg-white/20 rounded-full text-sm">RESTful API</span>
            </div>
            <a href="#overview" class="inline-flex items-center gap-2 bg-white text-purple-600 px-8 py-4 rounded-full font-bold hover:scale-105 transition">
                å¼€å§‹å­¦ä¹  <span class="arrow-animate">â†’</span>
            </a>
        </div>
    </section>

    <!-- æ¶æ„æ¦‚è§ˆ -->
    <section id="overview" class="py-20 px-4">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ</h2>
            <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                ç†è§£æ•´ä¸ªç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ¯ä¸ªéƒ¨åˆ†æ‰®æ¼”ä»€ä¹ˆè§’è‰²
            </p>

            <!-- æ¶æ„å›¾ -->
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-12">
                <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                    <!-- ç”¨æˆ· -->
                    <div class="text-center flex-1">
                        <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">
                            ğŸ‘¤
                        </div>
                        <h3 class="font-bold text-lg">ç”¨æˆ·</h3>
                        <p class="text-sm text-gray-500">æ‰“å¼€ç½‘é¡µæµè§ˆ</p>
                    </div>

                    <div class="text-3xl text-gray-300 arrow-animate">â†’</div>

                    <!-- å‰ç«¯ -->
                    <div class="text-center flex-1">
                        <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">
                            ğŸ–¥ï¸
                        </div>
                        <h3 class="font-bold text-lg">å‰ç«¯ (HTML)</h3>
                        <p class="text-sm text-gray-500">æ˜¾ç¤ºç•Œé¢ + å‘é€è¯·æ±‚</p>
                    </div>

                    <div class="text-3xl text-gray-300 arrow-animate">â†’</div>

                    <!-- åç«¯ -->
                    <div class="text-center flex-1">
                        <div class="w-24 h-24 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">
                            âš¡
                        </div>
                        <h3 class="font-bold text-lg">åç«¯ (Worker)</h3>
                        <p class="text-sm text-gray-500">å¤„ç†è¯·æ±‚ + ä¸šåŠ¡é€»è¾‘</p>
                    </div>

                    <div class="text-3xl text-gray-300 arrow-animate">â†’</div>

                    <!-- æ•°æ®åº“ -->
                    <div class="text-center flex-1">
                        <div class="w-24 h-24 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">
                            ğŸ—„ï¸
                        </div>
                        <h3 class="font-bold text-lg">æ•°æ®åº“ (D1)</h3>
                        <p class="text-sm text-gray-500">å­˜å‚¨è®¿é—®è®°å½•</p>
                    </div>
                </div>

                <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                    <p class="text-center text-sm text-gray-600">
                        <span class="font-bold">å·¥ä½œæµç¨‹ï¼š</span>
                        ç”¨æˆ·è®¿é—®ç½‘é¡µ â†’ å‰ç«¯ JavaScript å‘èµ· fetch è¯·æ±‚ â†’ Worker æ¥æ”¶è¯·æ±‚å¹¶å†™å…¥æ•°æ®åº“ â†’ æŸ¥è¯¢æ€»æ•° â†’ è¿”å› JSON â†’ å‰ç«¯æ›´æ–°æ˜¾ç¤º
                    </p>
                </div>
            </div>

            <!-- æŠ€æœ¯æ ˆå¡ç‰‡ -->
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-lg concept-card">
                    <div class="text-3xl mb-4">ğŸ“„</div>
                    <h3 class="font-bold text-lg mb-2">å‰ç«¯æŠ€æœ¯</h3>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>â€¢ <strong>HTML5</strong>: é¡µé¢ç»“æ„</li>
                        <li>â€¢ <strong>CSS3</strong>: æ ·å¼è®¾è®¡</li>
                        <li>â€¢ <strong>JavaScript</strong>: åŠ¨æ€äº¤äº’</li>
                        <li>â€¢ <strong>Fetch API</strong>: ç½‘ç»œè¯·æ±‚</li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-lg concept-card">
                    <div class="text-3xl mb-4">âš¡</div>
                    <h3 class="font-bold text-lg mb-2">åç«¯æŠ€æœ¯</h3>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>â€¢ <strong>Cloudflare Workers</strong>: è¾¹ç¼˜è®¡ç®—</li>
                        <li>â€¢ <strong>ES Modules</strong>: æ¨¡å—è¯­æ³•</li>
                        <li>â€¢ <strong>Async/Await</strong>: å¼‚æ­¥å¤„ç†</li>
                        <li>â€¢ <strong>RESTful API</strong>: æ¥å£è®¾è®¡</li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-lg concept-card">
                    <div class="text-3xl mb-4">ğŸ—„ï¸</div>
                    <h3 class="font-bold text-lg mb-2">æ•°æ®åº“æŠ€æœ¯</h3>
                    <ul class="text-sm text-gray-600 space-y-2">
                        <li>â€¢ <strong>D1</strong>: Cloudflare çš„ SQLite</li>
                        <li>â€¢ <strong>SQL</strong>: æ•°æ®æŸ¥è¯¢è¯­è¨€</li>
                        <li>â€¢ <strong>å‚æ•°åŒ–æŸ¥è¯¢</strong>: é˜² SQL æ³¨å…¥</li>
                        <li>â€¢ <strong>CRUD</strong>: å¢åˆ æ”¹æŸ¥</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- å‰ç«¯ä»£ç è¯¦è§£ -->
    <section id="frontend" class="py-20 px-4 bg-white">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">ğŸ“„ å‰ç«¯ä»£ç é€è¡Œè¯¦è§£</h2>
            <p class="text-center text-gray-600 mb-12">ç‚¹å‡»ä»»æ„ä»£ç è¡ŒæŸ¥çœ‹è¯¦ç»†è§£é‡Š</p>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- ä»£ç åŒºåŸŸ -->
                <div class="bg-gray-900 rounded-2xl overflow-hidden shadow-2xl">
                    <div class="flex items-center gap-2 px-4 py-3 bg-gray-800">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="ml-2 text-gray-400 text-sm">index.html</span>
                    </div>
                    <div class="p-4 overflow-x-auto text-sm" id="frontend-code">
                        <!-- ä»£ç å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- è§£é‡ŠåŒºåŸŸ -->
                <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-6 shadow-lg">
                    <div id="frontend-explanation" class="min-h-[400px]">
                        <div class="text-center py-12">
                            <div class="text-6xl mb-4">ğŸ‘†</div>
                            <p class="text-gray-500">ç‚¹å‡»å·¦ä¾§çš„ä»£ç è¡ŒæŸ¥çœ‹è¯¦ç»†è§£é‡Š</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- åç«¯ä»£ç è¯¦è§£ -->
    <section id="backend" class="py-20 px-4 bg-gray-100">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">âš¡ åç«¯ä»£ç é€è¡Œè¯¦è§£</h2>
            <p class="text-center text-gray-600 mb-12">ç‚¹å‡»ä»»æ„ä»£ç è¡ŒæŸ¥çœ‹è¯¦ç»†è§£é‡Š</p>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- ä»£ç åŒºåŸŸ -->
                <div class="bg-gray-900 rounded-2xl overflow-hidden shadow-2xl">
                    <div class="flex items-center gap-2 px-4 py-3 bg-gray-800">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="ml-2 text-gray-400 text-sm">src/index.js (Cloudflare Worker)</span>
                    </div>
                    <div class="p-4 overflow-x-auto text-sm" id="backend-code">
                        <!-- ä»£ç å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- è§£é‡ŠåŒºåŸŸ -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 shadow-lg">
                    <div id="backend-explanation" class="min-h-[400px]">
                        <div class="text-center py-12">
                            <div class="text-6xl mb-4">ğŸ‘†</div>
                            <p class="text-gray-500">ç‚¹å‡»å·¦ä¾§çš„ä»£ç è¡ŒæŸ¥çœ‹è¯¦ç»†è§£é‡Š</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- æ•°æ®æµåŠ¨å¯è§†åŒ– -->
    <section id="flow" class="py-20 px-4 bg-white">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">ğŸ”„ æ•°æ®æµåŠ¨å¯è§†åŒ–</h2>
            <p class="text-center text-gray-600 mb-12">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œè§‚å¯Ÿæ•°æ®å¦‚ä½•åœ¨å‰åç«¯ä¹‹é—´æµåŠ¨</p>

            <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl p-8 text-white">
                <!-- æµç¨‹æ§åˆ¶ -->
                <div class="flex justify-center gap-4 mb-8">
                    <button onclick="startFlow()" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-bold transition">
                        â–¶ï¸ å¼€å§‹æ¼”ç¤º
                    </button>
                    <button onclick="resetFlow()" class="px-6 py-3 bg-gray-600 hover:bg-gray-700 rounded-lg font-bold transition">
                        ğŸ”„ é‡ç½®
                    </button>
                </div>

                <!-- æµç¨‹å›¾ -->
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center mb-8">
                    <div id="flow-1" class="flow-step bg-blue-600/30 border-2 border-blue-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">ğŸ‘¤</div>
                        <div class="font-bold">ç”¨æˆ·è®¿é—®</div>
                        <div class="text-xs opacity-75">æ‰“å¼€ç½‘é¡µ</div>
                    </div>
                    <div class="text-center text-2xl hidden md:block">â†’</div>
                    <div id="flow-2" class="flow-step bg-green-600/30 border-2 border-green-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">ğŸ“¤</div>
                        <div class="font-bold">fetch è¯·æ±‚</div>
                        <div class="text-xs opacity-75">å‘é€åˆ° Worker</div>
                    </div>
                    <div class="text-center text-2xl hidden md:block">â†’</div>
                    <div id="flow-3" class="flow-step bg-purple-600/30 border-2 border-purple-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">âš¡</div>
                        <div class="font-bold">Worker å¤„ç†</div>
                        <div class="text-xs opacity-75">CORS + æ”¶é›†ä¿¡æ¯</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center mb-8">
                    <div id="flow-4" class="flow-step bg-orange-600/30 border-2 border-orange-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">ğŸ’¾</div>
                        <div class="font-bold">å†™å…¥æ•°æ®åº“</div>
                        <div class="text-xs opacity-75">INSERT è¯­å¥</div>
                    </div>
                    <div class="text-center text-2xl hidden md:block">â†’</div>
                    <div id="flow-5" class="flow-step bg-yellow-600/30 border-2 border-yellow-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">ğŸ”</div>
                        <div class="font-bold">æŸ¥è¯¢æ€»æ•°</div>
                        <div class="text-xs opacity-75">SELECT COUNT</div>
                    </div>
                    <div class="text-center text-2xl hidden md:block">â†’</div>
                    <div id="flow-6" class="flow-step bg-pink-600/30 border-2 border-pink-500 rounded-xl p-4 text-center">
                        <div class="text-3xl mb-2">ğŸ“¥</div>
                        <div class="font-bold">è¿”å› JSON</div>
                        <div class="text-xs opacity-75">å¸¦ CORS å¤´</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center">
                    <div class="md:col-start-3">
                        <div id="flow-7" class="flow-step bg-cyan-600/30 border-2 border-cyan-500 rounded-xl p-4 text-center">
                            <div class="text-3xl mb-2">âœ¨</div>
                            <div class="font-bold">æ›´æ–°é¡µé¢</div>
                            <div class="text-xs opacity-75">æ˜¾ç¤ºè®¡æ•°</div>
                        </div>
                    </div>
                </div>

                <!-- å½“å‰æ­¥éª¤è¯´æ˜ -->
                <div id="flow-description" class="mt-8 p-4 bg-white/10 rounded-lg text-center">
                    <p>ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"è§‚å¯Ÿæ•°æ®æµåŠ¨è¿‡ç¨‹</p>
                </div>
            </div>
        </div>
    </section>

    <!-- æ ¸å¿ƒæ¦‚å¿µæ·±å…¥ -->
    <section id="concepts" class="py-20 px-4 bg-gray-100">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µæ·±å…¥</h2>
            <p class="text-center text-gray-600 mb-12">ç‚¹å‡»å¡ç‰‡å±•å¼€è¯¦ç»†å†…å®¹</p>

            <div class="space-y-6">
                <!-- CORS -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <button onclick="toggleConcept('cors')" class="w-full p-6 flex items-center justify-between hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">ğŸ›¡ï¸</span>
                            <div class="text-left">
                                <h3 class="font-bold text-xl">CORS (è·¨åŸŸèµ„æºå…±äº«)</h3>
                                <p class="text-gray-500">æµè§ˆå™¨å®‰å…¨æœºåˆ¶ä¸è§£å†³æ–¹æ¡ˆ</p>
                            </div>
                        </div>
                        <span id="cors-arrow" class="text-2xl transition-transform">â–¼</span>
                    </button>
                    <div id="cors-content" class="hidden px-6 pb-6">
                        <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ¤” ä»€ä¹ˆæ˜¯ CORSï¼Ÿ</h4>
                                <p class="text-gray-600">CORS (Cross-Origin Resource Sharing) æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨ç­–ç•¥ã€‚å½“ä½ çš„ç½‘é¡µï¼ˆæºAï¼‰è¯•å›¾è¯·æ±‚å¦ä¸€ä¸ªä¸åŒåŸŸåçš„æœåŠ¡å™¨ï¼ˆæºBï¼‰æ—¶ï¼Œæµè§ˆå™¨ä¼šé˜»æ­¢è¿™ä¸ªè¯·æ±‚ï¼Œé™¤éæœåŠ¡å™¨æ˜ç¡®è¡¨ç¤º"æˆ‘å…è®¸ä½ è®¿é—®"ã€‚</p>
                            </div>

                            <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                <h5 class="font-bold text-red-700">âŒ æ²¡æœ‰ CORS å¤´æ—¶çš„é”™è¯¯</h5>
                                <code class="text-sm text-red-600 block mt-2">
                                    Access to fetch at 'https://api.example.com' from origin 'http://localhost' has been blocked by CORS policy
                                </code>
                            </div>

                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                <h5 class="font-bold text-green-700">âœ… è§£å†³æ–¹æ¡ˆ</h5>
                                <pre class="text-sm mt-2 bg-gray-800 text-white p-3 rounded overflow-x-auto"><code>const corsHeaders = {
  "Access-Control-Allow-Origin": "*",      // å…è®¸æ‰€æœ‰æ¥æº
  "Access-Control-Allow-Methods": "GET,POST", // å…è®¸çš„æ–¹æ³•
  "Access-Control-Allow-Headers": "Content-Type" // å…è®¸çš„è¯·æ±‚å¤´
};</code></pre>
                            </div>

                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ” é¢„æ£€è¯·æ±‚ (Preflight)</h4>
                                <p class="text-gray-600 mb-2">æµè§ˆå™¨åœ¨å‘é€æŸäº›è¯·æ±‚å‰ï¼Œä¼šå…ˆå‘ä¸€ä¸ª OPTIONS è¯·æ±‚"æ‰“æ¢ä¸€ä¸‹"ï¼š</p>
                                <div class="flex items-center gap-4 text-sm">
                                    <div class="bg-blue-100 p-3 rounded flex-1 text-center">
                                        <div class="font-bold">æµè§ˆå™¨</div>
                                        <div class="text-xs">OPTIONS /api</div>
                                        <div class="text-xs">"æˆ‘èƒ½è®¿é—®ä½ å—ï¼Ÿ"</div>
                                    </div>
                                    <span>â†’</span>
                                    <div class="bg-purple-100 p-3 rounded flex-1 text-center">
                                        <div class="font-bold">æœåŠ¡å™¨</div>
                                        <div class="text-xs">200 OK + CORSå¤´</div>
                                        <div class="text-xs">"å¯ä»¥ï¼Œæ¥å§"</div>
                                    </div>
                                    <span>â†’</span>
                                    <div class="bg-green-100 p-3 rounded flex-1 text-center">
                                        <div class="font-bold">æµè§ˆå™¨</div>
                                        <div class="text-xs">GET /api</div>
                                        <div class="text-xs">"æ­£å¼è¯·æ±‚"</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SQL æ³¨å…¥ -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <button onclick="toggleConcept('sql')" class="w-full p-6 flex items-center justify-between hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">ğŸ’‰</span>
                            <div class="text-left">
                                <h3 class="font-bold text-xl">SQL æ³¨å…¥é˜²æŠ¤</h3>
                                <p class="text-gray-500">å‚æ•°åŒ–æŸ¥è¯¢çš„é‡è¦æ€§</p>
                            </div>
                        </div>
                        <span id="sql-arrow" class="text-2xl transition-transform">â–¼</span>
                    </button>
                    <div id="sql-content" class="hidden px-6 pb-6">
                        <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ¤” ä»€ä¹ˆæ˜¯ SQL æ³¨å…¥ï¼Ÿ</h4>
                                <p class="text-gray-600">SQL æ³¨å…¥æ˜¯ä¸€ç§æ”»å‡»æ–¹å¼ï¼Œé»‘å®¢é€šè¿‡åœ¨è¾“å…¥æ¡†ä¸­å¡«å…¥ç‰¹æ®Šçš„ SQL ä»£ç ï¼Œè¯•å›¾æ“æ§æ•°æ®åº“æ‰§è¡Œéé¢„æœŸçš„å‘½ä»¤ã€‚</p>
                            </div>

                            <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                <h5 class="font-bold text-red-700">âŒ å±é™©çš„å­—ç¬¦ä¸²æ‹¼æ¥</h5>
                                <pre class="text-sm mt-2 bg-gray-800 text-white p-3 rounded overflow-x-auto"><code>// ğŸš« åƒä¸‡ä¸è¦è¿™æ ·å†™ï¼
const sql = "INSERT INTO logs VALUES ('" + userInput + "')";
// å¦‚æœ userInput = "'); DROP TABLE logs; --"
// æœ€ç»ˆ SQL å˜æˆï¼šINSERT INTO logs VALUES (''); DROP TABLE logs; --')
// ä½ çš„è¡¨å°±è¢«åˆ é™¤äº†ï¼</code></pre>
                            </div>

                            <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                <h5 class="font-bold text-green-700">âœ… å®‰å…¨çš„å‚æ•°åŒ–æŸ¥è¯¢</h5>
                                <pre class="text-sm mt-2 bg-gray-800 text-white p-3 rounded overflow-x-auto"><code>// âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ ? å ä½ç¬¦
await env.DB.prepare(
  "INSERT INTO Visit_Logs (access_time, country, user_agent) VALUES (?, ?, ?)"
).bind(time, country, userAgent).run();

// æ•°æ®åº“ä¼šè‡ªåŠ¨æŠŠå‚æ•°å½“ä½œ"çº¯æ–‡æœ¬"å¤„ç†
// ä»»ä½•æ¶æ„ä»£ç éƒ½åªä¼šè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²å­˜å‚¨</code></pre>
                            </div>

                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <h5 class="font-bold text-yellow-700">ğŸ’¡ è®°å¿†å£è¯€</h5>
                                <p class="text-yellow-800 font-bold">"æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥ï¼Œæ°¸è¿œä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢"</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Async/Await -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <button onclick="toggleConcept('async')" class="w-full p-6 flex items-center justify-between hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">â³</span>
                            <div class="text-left">
                                <h3 class="font-bold text-xl">Async/Await å¼‚æ­¥ç¼–ç¨‹</h3>
                                <p class="text-gray-500">ç†è§£ JavaScript çš„å¼‚æ­¥æœºåˆ¶</p>
                            </div>
                        </div>
                        <span id="async-arrow" class="text-2xl transition-transform">â–¼</span>
                    </button>
                    <div id="async-content" class="hidden px-6 pb-6">
                        <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥ï¼Ÿ</h4>
                                <p class="text-gray-600">ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æ“ä½œéƒ½æ˜¯"è€—æ—¶æ“ä½œ"ã€‚å¦‚æœ JavaScript å‚»ç­‰è¿™äº›æ“ä½œå®Œæˆï¼Œé¡µé¢å°±ä¼šå¡ä½ã€‚å¼‚æ­¥è®©ç¨‹åº"å…ˆå»åšåˆ«çš„äº‹ï¼Œç­‰ç»“æœå›æ¥å†å¤„ç†"ã€‚</p>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="bg-blue-50 p-4 rounded">
                                    <h5 class="font-bold text-blue-700 mb-2">async å‡½æ•°</h5>
                                    <pre class="text-sm bg-gray-800 text-white p-3 rounded"><code>async function fetchData() {
  // æ ‡è®°è¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥çš„
  // å®ƒä¼šè¿”å›ä¸€ä¸ª Promise
}</code></pre>
                                </div>
                                <div class="bg-purple-50 p-4 rounded">
                                    <h5 class="font-bold text-purple-700 mb-2">await å…³é”®å­—</h5>
                                    <pre class="text-sm bg-gray-800 text-white p-3 rounded"><code>const result = await fetch(url);
// "ç­‰ç­‰ï¼Œç­‰è¿™ä¸ªè¯·æ±‚å®Œæˆ"
// æ‹¿åˆ°ç»“æœåå†ç»§ç»­æ‰§è¡Œ</code></pre>
                                </div>
                            </div>

                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ”„ æ‰§è¡Œæµç¨‹å›¾è§£</h4>
                                <div class="bg-white p-4 rounded border space-y-2 text-sm">
                                    <div class="flex items-center gap-2">
                                        <span class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs">1</span>
                                        <code>const response = await fetch(API_URL);</code>
                                        <span class="text-gray-400">â† å‘é€è¯·æ±‚ï¼Œæš‚åœç­‰å¾…</span>
                                    </div>
                                    <div class="ml-8 text-gray-500 text-xs">â³ ç½‘ç»œä¼ è¾“ä¸­... (å…¶ä»–ä»£ç å¯ä»¥æ‰§è¡Œ)</div>
                                    <div class="flex items-center gap-2">
                                        <span class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs">2</span>
                                        <code>const data = await response.json();</code>
                                        <span class="text-gray-400">â† è§£æ JSONï¼Œæš‚åœç­‰å¾…</span>
                                    </div>
                                    <div class="ml-8 text-gray-500 text-xs">â³ è§£æä¸­...</div>
                                    <div class="flex items-center gap-2">
                                        <span class="w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-xs">3</span>
                                        <code>document.getElementById(...).innerText = data.total;</code>
                                        <span class="text-gray-400">â† æ›´æ–°é¡µé¢</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- request.cf -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <button onclick="toggleConcept('cf')" class="w-full p-6 flex items-center justify-between hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">ğŸŒ</span>
                            <div class="text-left">
                                <h3 class="font-bold text-xl">request.cf è¾¹ç¼˜è®¡ç®—å…ƒæ•°æ®</h3>
                                <p class="text-gray-500">Cloudflare æä¾›çš„åœ°ç†ä½ç½®ä¿¡æ¯</p>
                            </div>
                        </div>
                        <span id="cf-arrow" class="text-2xl transition-transform">â–¼</span>
                    </button>
                    <div id="cf-content" class="hidden px-6 pb-6">
                        <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ¤” ä»€ä¹ˆæ˜¯ request.cfï¼Ÿ</h4>
                                <p class="text-gray-600">å½“è¯·æ±‚ç»è¿‡ Cloudflare çš„å…¨çƒç½‘ç»œæ—¶ï¼ŒCloudflare ä¼šè‡ªåŠ¨åˆ†æè¯·æ±‚æ¥æºï¼Œå¹¶æŠŠè¿™äº›ä¿¡æ¯é™„åŠ åˆ° <code>request.cf</code> å¯¹è±¡ä¸­ã€‚è¿™æ˜¯è¾¹ç¼˜è®¡ç®—çš„ç¦åˆ©ï¼</p>
                            </div>

                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                                <h5 class="font-bold text-orange-700 mb-2">ğŸ“¦ request.cf åŒ…å«çš„ä¿¡æ¯</h5>
                                <pre class="text-sm bg-gray-800 text-white p-3 rounded overflow-x-auto"><code>{
  country: "CN",           // å›½å®¶ä»£ç 
  city: "Shanghai",        // åŸå¸‚
  continent: "AS",         // å¤§æ´²
  latitude: "31.2222",     // çº¬åº¦
  longitude: "121.4581",   // ç»åº¦
  region: "Shanghai",      // åœ°åŒº
  timezone: "Asia/Shanghai", // æ—¶åŒº
  postalCode: "200000",    // é‚®ç¼–
  // è¿˜æœ‰æ›´å¤š...
}</code></pre>
                            </div>

                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ”’ å¯é€‰é“¾æ“ä½œç¬¦ (?.) </h4>
                                <pre class="text-sm bg-gray-800 text-white p-3 rounded overflow-x-auto"><code>const country = request.cf?.country || "Unknown";

// è¿™è¡Œä»£ç ç­‰ä»·äºï¼š
let country;
if (request.cf && request.cf.country) {
  country = request.cf.country;
} else {
  country = "Unknown";
}</code></pre>
                                <p class="text-sm text-gray-600 mt-2">ä½¿ç”¨ <code>?.</code> å¯ä»¥å®‰å…¨åœ°è®¿é—®å¯èƒ½ä¸å­˜åœ¨çš„å±æ€§ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Try-Catch -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <button onclick="toggleConcept('try')" class="w-full p-6 flex items-center justify-between hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">ğŸ› ï¸</span>
                            <div class="text-left">
                                <h3 class="font-bold text-xl">Try-Catch é”™è¯¯å¤„ç†</h3>
                                <p class="text-gray-500">ä¼˜é›…åœ°å¤„ç†ç¨‹åºå¼‚å¸¸</p>
                            </div>
                        </div>
                        <span id="try-arrow" class="text-2xl transition-transform">â–¼</span>
                    </button>
                    <div id="try-content" class="hidden px-6 pb-6">
                        <div class="bg-gray-50 rounded-xl p-6 space-y-4">
                            <div>
                                <h4 class="font-bold text-lg mb-2">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦é”™è¯¯å¤„ç†ï¼Ÿ</h4>
                                <p class="text-gray-600">ç½‘ç»œå¯èƒ½æ–­å¼€ã€æ•°æ®åº“å¯èƒ½æ»¡äº†ã€æœåŠ¡å™¨å¯èƒ½å´©æºƒ... å¦‚æœä¸å¤„ç†è¿™äº›é”™è¯¯ï¼Œç”¨æˆ·çœ‹åˆ°çš„å°±æ˜¯ç™½å±æˆ–è€…éš¾ä»¥ç†è§£çš„æŠ¥é”™ã€‚</p>
                            </div>

                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="bg-red-50 p-4 rounded">
                                    <h5 class="font-bold text-red-700 mb-2">âŒ ä¸å¤„ç†é”™è¯¯</h5>
                                    <pre class="text-sm bg-gray-800 text-white p-3 rounded"><code>const data = await fetch(url);
// å¦‚æœç½‘ç»œå¤±è´¥ï¼Œç¨‹åºç›´æ¥å´©æºƒ
// ç”¨æˆ·çœ‹åˆ°ç™½å±</code></pre>
                                </div>
                                <div class="bg-green-50 p-4 rounded">
                                    <h5 class="font-bold text-green-700 mb-2">âœ… ä¼˜é›…å¤„ç†</h5>
                                    <pre class="text-sm bg-gray-800 text-white p-3 rounded"><code>try {
  const data = await fetch(url);
} catch (error) {
  showMessage("ç½‘ç»œå¤±è´¥");
}</code></pre>
                                </div>
                            </div>

                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                <h5 class="font-bold text-blue-700 mb-2">ğŸ’¡ æœ€ä½³å®è·µ</h5>
                                <ul class="text-sm text-blue-800 space-y-1">
                                    <li>â€¢ åç«¯é”™è¯¯æ—¶ä¹Ÿè¦è¿”å› CORS å¤´ï¼Œå¦åˆ™å‰ç«¯çœ‹åˆ°çš„æ˜¯"ç½‘ç»œé”™è¯¯"è€ŒéçœŸå®é”™è¯¯</li>
                                    <li>â€¢ ç»™ç”¨æˆ·å‹å¥½çš„æç¤ºï¼Œè€ŒéæŠ€æœ¯æ€§æŠ¥é”™</li>
                                    <li>â€¢ ä½¿ç”¨ console.error() è®°å½•è¯¦ç»†é”™è¯¯ä¾›å¼€å‘è€…æ’æŸ¥</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- äº’åŠ¨æµ‹éªŒ -->
    <section id="quiz" class="py-20 px-4 bg-gradient-to-br from-purple-600 to-pink-600 text-white">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-4xl font-bold text-center mb-4">ğŸ¯ çŸ¥è¯†æµ‹éªŒ</h2>
            <p class="text-center opacity-90 mb-12">æ£€éªŒä¸€ä¸‹ä½ çš„ç†è§£ç¨‹åº¦ï¼</p>

            <div id="quiz-container" class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                <div id="quiz-question" class="text-xl font-bold mb-6"></div>
                <div id="quiz-options" class="space-y-3"></div>
                <div id="quiz-feedback" class="mt-6 hidden p-4 rounded-lg"></div>
                <div class="mt-6 flex justify-between items-center">
                    <div id="quiz-progress" class="text-sm opacity-75"></div>
                    <button id="quiz-next" onclick="nextQuestion()" class="hidden px-6 py-2 bg-white text-purple-600 rounded-lg font-bold hover:scale-105 transition">
                        ä¸‹ä¸€é¢˜ â†’
                    </button>
                </div>
            </div>

            <div id="quiz-result" class="hidden text-center py-12">
                <div class="text-6xl mb-4">ğŸ‰</div>
                <h3 class="text-3xl font-bold mb-4">æµ‹éªŒå®Œæˆï¼</h3>
                <p id="quiz-score" class="text-xl mb-6"></p>
                <button onclick="restartQuiz()" class="px-8 py-3 bg-white text-purple-600 rounded-lg font-bold hover:scale-105 transition">
                    é‡æ–°æµ‹éªŒ
                </button>
            </div>
        </div>
    </section>

    <!-- é¡µè„š -->
    <footer class="bg-gray-900 text-white py-12 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <p class="text-gray-400 mb-4">ğŸ“š å…¨æ ˆè®¡æ•°å™¨æ•™ç¨‹ - äº¤äº’å¼å­¦ä¹ </p>
            <p class="text-sm text-gray-500">æŒæ¡äº†è¿™äº›çŸ¥è¯†ï¼Œä½ å°±å¯ä»¥æ„å»ºæ›´å¤æ‚çš„å…¨æ ˆåº”ç”¨äº†ï¼</p>
            <div class="mt-6 flex justify-center gap-4 text-sm">
                <span class="px-3 py-1 bg-gray-800 rounded">HTML</span>
                <span class="px-3 py-1 bg-gray-800 rounded">CSS</span>
                <span class="px-3 py-1 bg-gray-800 rounded">JavaScript</span>
                <span class="px-3 py-1 bg-gray-800 rounded">Cloudflare Workers</span>
                <span class="px-3 py-1 bg-gray-800 rounded">D1 Database</span>
            </div>
        </div>
    </footer>

    <script>
        // ==================== å‰ç«¯ä»£ç æ•°æ® ====================
        const frontendLines = [
            { code: '<!DOCTYPE html>', type: 'html', explanation: { title: 'HTML5 æ–‡æ¡£å£°æ˜', content: 'è¿™æ˜¯ HTML5 çš„æ ‡å‡†å£°æ˜ï¼Œå‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯ä¸€ä¸ª HTML5 æ–‡æ¡£ã€‚å¿…é¡»æ”¾åœ¨æ–‡æ¡£æœ€å¼€å¤´ã€‚', icon: 'ğŸ“„' }},
            { code: '<html lang="zh-CN">', type: 'html', explanation: { title: 'HTML æ ¹å…ƒç´ ', content: '<strong>lang="zh-CN"</strong> å‘Šè¯‰æœç´¢å¼•æ“å’Œå±å¹•é˜…è¯»å™¨è¿™æ˜¯ç®€ä½“ä¸­æ–‡é¡µé¢ï¼Œæœ‰åŠ©äº SEO å’Œæ— éšœç¢è®¿é—®ã€‚', icon: 'ğŸŒ' }},
            { code: '<head>', type: 'html', explanation: { title: 'head æ ‡ç­¾', content: 'å¤´éƒ¨åŒºåŸŸï¼ŒåŒ…å«é¡µé¢çš„å…ƒä¿¡æ¯ï¼ˆå¦‚ç¼–ç ã€æ ‡é¢˜ã€æ ·å¼ï¼‰ï¼Œè¿™äº›å†…å®¹ä¸ä¼šç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚', icon: 'ğŸ§ ' }},
            { code: '    <meta charset="UTF-8">', type: 'html', explanation: { title: 'å­—ç¬¦ç¼–ç å£°æ˜', content: 'UTF-8 æ˜¯ä¸€ç§é€šç”¨ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡ã€æ—¥æ–‡ã€è¡¨æƒ…ç¬¦å·ç­‰å‡ ä¹æ‰€æœ‰å­—ç¬¦ã€‚æ²¡æœ‰å®ƒï¼Œä¸­æ–‡å¯èƒ½æ˜¾ç¤ºä¸ºä¹±ç ã€‚', icon: 'ğŸ”¤' }},
            { code: '    <meta name="viewport" content="width=device-width, initial-scale=1.0">', type: 'html', explanation: { title: 'è§†å£è®¾ç½®', content: 'è®©é¡µé¢åœ¨æ‰‹æœºä¸Šä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºã€‚<br><strong>width=device-width</strong>: å®½åº¦ç­‰äºè®¾å¤‡å®½åº¦<br><strong>initial-scale=1.0</strong>: åˆå§‹ç¼©æ”¾æ¯”ä¾‹ä¸º 1', icon: 'ğŸ“±' }},
            { code: '    <title>æˆ‘çš„å…¨æ ˆè®¡æ•°å™¨</title>', type: 'html', explanation: { title: 'é¡µé¢æ ‡é¢˜', content: 'æ˜¾ç¤ºåœ¨æµè§ˆå™¨æ ‡ç­¾é¡µä¸Šçš„æ–‡å­—ï¼Œä¹Ÿæ˜¯æœç´¢å¼•æ“æŠ“å–çš„é‡è¦ä¿¡æ¯ã€‚', icon: 'ğŸ·ï¸' }},
            { code: '    <style>', type: 'css', explanation: { title: 'style å†…éƒ¨æ ·å¼è¡¨', content: 'åœ¨ HTML æ–‡ä»¶å†…ç›´æ¥ç¼–å†™ CSS æ ·å¼ã€‚é€‚åˆå°å‹é¡¹ç›®æˆ–ç‹¬ç«‹é¡µé¢ã€‚', icon: 'ğŸ¨' }},
            { code: '        body { display: flex; justify-content: center; ... }', type: 'css', explanation: { title: 'Flexbox å±…ä¸­å¸ƒå±€', content: '<strong>display: flex</strong>: å¯ç”¨å¼¹æ€§ç›’å¸ƒå±€<br><strong>justify-content: center</strong>: æ°´å¹³å±…ä¸­<br><strong>align-items: center</strong>: å‚ç›´å±…ä¸­<br><strong>height: 100vh</strong>: é«˜åº¦ä¸ºè§†çª—çš„ 100%', icon: 'ğŸ“' }},
            { code: '        .card { background: white; padding: 2rem; ... }', type: 'css', explanation: { title: 'å¡ç‰‡æ ·å¼', content: '<strong>border-radius: 1rem</strong>: åœ†è§’è¾¹æ¡†<br><strong>box-shadow</strong>: é˜´å½±æ•ˆæœï¼Œè®©å¡ç‰‡"æµ®èµ·æ¥"<br><strong>text-align: center</strong>: æ–‡å­—å±…ä¸­', icon: 'ğŸƒ' }},
            { code: '    </style>', type: 'css', explanation: { title: 'æ ·å¼æ ‡ç­¾ç»“æŸ', content: 'CSS ä»£ç ç»“æŸã€‚', icon: 'âœ…' }},
            { code: '</head>', type: 'html', explanation: { title: 'head ç»“æŸ', content: 'å¤´éƒ¨ä¿¡æ¯å®šä¹‰å®Œæ¯•ï¼Œæ¥ä¸‹æ¥æ˜¯é¡µé¢å¯è§å†…å®¹ã€‚', icon: 'âœ…' }},
            { code: '<body>', type: 'html', explanation: { title: 'body å¼€å§‹', content: 'é¡µé¢çš„ä¸»ä½“å†…å®¹åŒºåŸŸï¼Œç”¨æˆ·èƒ½çœ‹åˆ°çš„æ‰€æœ‰å†…å®¹éƒ½åœ¨è¿™é‡Œã€‚', icon: 'ğŸ‘ï¸' }},
            { code: '    <div class="card">', type: 'html', explanation: { title: 'å¡ç‰‡å®¹å™¨', content: 'class="card" åº”ç”¨äº†ä¸Šé¢å®šä¹‰çš„ .card æ ·å¼ï¼Œåˆ›å»ºä¸€ä¸ªç™½è‰²åœ†è§’å¡ç‰‡ã€‚', icon: 'ğŸ“¦' }},
            { code: '        <p>ç½‘é¡µæ€»è®¿é—®é‡</p>', type: 'html', explanation: { title: 'æ®µè½æ–‡å­—', content: 'é™æ€æ–‡å­—ï¼Œå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªæ•°å­—ä»£è¡¨ä»€ä¹ˆã€‚', icon: 'ğŸ“' }},
            { code: '        <h1 id="count-display">...</h1>', type: 'html', explanation: { title: 'è®¡æ•°æ˜¾ç¤ºåŒº', content: '<strong>id="count-display"</strong> ç»™è¿™ä¸ªå…ƒç´ ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼ŒJavaScript å¯ä»¥é€šè¿‡è¿™ä¸ª ID æ‰¾åˆ°å®ƒå¹¶æ›´æ–°å†…å®¹ã€‚åˆå§‹æ˜¾ç¤º "..." è¡¨ç¤ºæ­£åœ¨åŠ è½½ã€‚', icon: 'ğŸ”¢' }},
            { code: '        <div class="info" id="info-display">æ­£åœ¨è¿æ¥åç«¯...</div>', type: 'html', explanation: { title: 'ä¿¡æ¯æ˜¾ç¤ºåŒº', content: 'ç”¨äºæ˜¾ç¤ºç”¨æˆ·ä½ç½®ä¿¡æ¯ã€‚id="info-display" è®© JS å¯ä»¥åŠ¨æ€æ›´æ–°å®ƒã€‚', icon: 'ğŸ“' }},
            { code: '        <div class="info" id="info-display1"></div>', type: 'html', explanation: { title: 'ç”¨æˆ·ä»£ç†æ˜¾ç¤ºåŒº', content: 'ç”¨äºæ˜¾ç¤ºç”¨æˆ·çš„æµè§ˆå™¨/è®¾å¤‡ä¿¡æ¯ã€‚', icon: 'ğŸ’»' }},
            { code: '    </div>', type: 'html', explanation: { title: 'div ç»“æŸ', content: 'å¡ç‰‡å®¹å™¨å…³é—­ã€‚', icon: 'âœ…' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: 'å¢åŠ ä»£ç å¯è¯»æ€§ã€‚', icon: 'ğŸ“' }},
            { code: '    <script>', type: 'js', explanation: { title: 'JavaScript å¼€å§‹', content: 'é¡µé¢çš„åŠ¨æ€äº¤äº’é€»è¾‘ä»è¿™é‡Œå¼€å§‹ã€‚', icon: 'âš¡' }},
            { code: '        const API_URL = "https://db.myname.workers.dev/";', type: 'js', explanation: { title: 'API åœ°å€å¸¸é‡', content: '<strong>const</strong>: å£°æ˜å¸¸é‡ï¼ˆä¸å¯ä¿®æ”¹ï¼‰<br>è¿™ä¸ª URL æŒ‡å‘ä½ éƒ¨ç½²çš„ Cloudflare Worker åç«¯ã€‚<br>âš ï¸ éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„ Worker åœ°å€ï¼', icon: 'ğŸ”—' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '        async function recordVisit() {', type: 'js', explanation: { title: 'å¼‚æ­¥å‡½æ•°å®šä¹‰', content: '<strong>async</strong>: æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°<br><strong>function recordVisit()</strong>: å‡½æ•°åå« recordVisitï¼ˆè®°å½•è®¿é—®ï¼‰<br>å¼‚æ­¥å‡½æ•°å†…å¯ä»¥ä½¿ç”¨ await ç­‰å¾…è€—æ—¶æ“ä½œã€‚', icon: 'ğŸ”„' }},
            { code: '            try {', type: 'js', explanation: { title: 'try å—å¼€å§‹', content: 'å°è¯•æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚å¦‚æœå‡ºé”™ï¼Œä¼šè·³è½¬åˆ° catch å—ï¼Œè€Œä¸æ˜¯è®©ç¨‹åºå´©æºƒã€‚è¿™å«"é”™è¯¯å¤„ç†"ã€‚', icon: 'ğŸ›¡ï¸' }},
            { code: '                const response = await fetch(API_URL);', type: 'js', explanation: { title: 'å‘é€ HTTP è¯·æ±‚', content: '<strong>fetch(API_URL)</strong>: å‘åç«¯å‘é€ GET è¯·æ±‚<br><strong>await</strong>: ç­‰å¾…è¯·æ±‚å®Œæˆ<br><strong>const response</strong>: æŠŠå“åº”å¯¹è±¡ä¿å­˜åˆ°å˜é‡<br>response åŒ…å«çŠ¶æ€ç ã€å“åº”å¤´ç­‰ä¿¡æ¯ã€‚', icon: 'ğŸ“¤' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '                const data = await response.json();', type: 'js', explanation: { title: 'è§£æ JSON', content: '<strong>response.json()</strong>: æŠŠå“åº”ä½“è§£æä¸º JavaScript å¯¹è±¡<br><strong>await</strong>: è§£æä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œï¼Œéœ€è¦ç­‰å¾…<br>è§£æå data å°±æ˜¯åç«¯è¿”å›çš„å¯¹è±¡ï¼Œå¦‚ { total_visits: 123, your_info: {...} }', icon: 'ğŸ“¥' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '                document.getElementById(\'count-display\').innerText = data.total_visits;', type: 'js', explanation: { title: 'æ›´æ–°è®¿é—®é‡æ˜¾ç¤º', content: '<strong>document.getElementById()</strong>: é€šè¿‡ ID æ‰¾åˆ°é¡µé¢å…ƒç´ <br><strong>.innerText</strong>: è®¾ç½®å…ƒç´ çš„æ–‡æœ¬å†…å®¹<br><strong>data.total_visits</strong>: åç«¯è¿”å›çš„æ€»è®¿é—®é‡', icon: 'ğŸ”¢' }},
            { code: '                document.getElementById(\'info-display\').innerText = `ä½ çš„ä½ç½®: ${data.your_info.country}`;', type: 'js', explanation: { title: 'æ›´æ–°ä½ç½®ä¿¡æ¯', content: '<strong>æ¨¡æ¿å­—ç¬¦ä¸² `...`</strong>: ç”¨åå¼•å·åŒ…è£¹ï¼Œå¯ä»¥ç”¨ ${} æ’å…¥å˜é‡<br><strong>data.your_info.country</strong>: åç«¯è¿”å›çš„å›½å®¶ä»£ç ', icon: 'ğŸ“' }},
            { code: '                document.getElementById(\'info-display1\').innerText = `ä½ çš„ç»ˆç«¯: ${data.your_info.userAgent}`;', type: 'js', explanation: { title: 'æ›´æ–°è®¾å¤‡ä¿¡æ¯', content: 'æ˜¾ç¤ºç”¨æˆ·çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯ï¼ˆUser-Agentï¼‰ã€‚', icon: 'ğŸ’»' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '            } catch (error) {', type: 'js', explanation: { title: 'catch é”™è¯¯æ•è·', content: 'å¦‚æœ try å—ä¸­ä»»ä½•ä»£ç å‡ºé”™ï¼ˆå¦‚ç½‘ç»œæ–­å¼€ï¼‰ï¼Œç¨‹åºä¼šè·³åˆ°è¿™é‡Œã€‚<br><strong>error</strong> å˜é‡åŒ…å«é”™è¯¯è¯¦æƒ…ã€‚', icon: 'ğŸš¨' }},
            { code: '                console.error("å‡ºé”™äº†:", error);', type: 'js', explanation: { title: 'æ‰“å°é”™è¯¯æ—¥å¿—', content: '<strong>console.error()</strong>: åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°æ‰“å°çº¢è‰²é”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚', icon: 'ğŸ”' }},
            { code: '                document.getElementById(\'info-display\').innerText = "è¿æ¥æœåŠ¡å™¨å¤±è´¥";', type: 'js', explanation: { title: 'æ˜¾ç¤ºå‹å¥½é”™è¯¯æç¤º', content: 'ç»™ç”¨æˆ·ä¸€ä¸ªäººç±»å¯è¯»çš„æç¤ºï¼Œè€Œä¸æ˜¯è®©ä»–ä»¬çœ‹åˆ°ç™½å±æˆ–æŠ€æœ¯æ€§æŠ¥é”™ã€‚', icon: 'âš ï¸' }},
            { code: '            }', type: 'js', explanation: { title: 'try-catch ç»“æŸ', content: 'é”™è¯¯å¤„ç†å—ç»“æŸã€‚', icon: 'âœ…' }},
            { code: '        }', type: 'js', explanation: { title: 'å‡½æ•°ç»“æŸ', content: 'recordVisit å‡½æ•°å®šä¹‰å®Œæ¯•ã€‚', icon: 'âœ…' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '        recordVisit();', type: 'js', explanation: { title: 'ç«‹å³è°ƒç”¨å‡½æ•°', content: 'é¡µé¢åŠ è½½å®Œæˆåï¼Œç«‹å³æ‰§è¡Œ recordVisit() å‡½æ•°ï¼Œå‘èµ·è¯·æ±‚è·å–æ•°æ®ã€‚è¿™è¡Œæ˜¯å®é™…è§¦å‘ç½‘ç»œè¯·æ±‚çš„ä»£ç ï¼', icon: 'ğŸš€' }},
            { code: '    </script>', type: 'js', explanation: { title: 'JavaScript ç»“æŸ', content: 'è„šæœ¬æ ‡ç­¾å…³é—­ã€‚', icon: 'âœ…' }},
            { code: '</body>', type: 'html', explanation: { title: 'body ç»“æŸ', content: 'é¡µé¢ä¸»ä½“å†…å®¹ç»“æŸã€‚', icon: 'âœ…' }},
            { code: '</html>', type: 'html', explanation: { title: 'HTML ç»“æŸ', content: 'æ•´ä¸ª HTML æ–‡æ¡£ç»“æŸã€‚', icon: 'ğŸ' }},
        ];

        // ==================== åç«¯ä»£ç æ•°æ® ====================
        const backendLines = [
            { code: 'export default {', type: 'js', explanation: { title: 'ES Module å¯¼å‡º', content: '<strong>export default</strong>: ES6 æ¨¡å—è¯­æ³•ï¼Œå¯¼å‡ºä¸€ä¸ªé»˜è®¤å¯¹è±¡<br>Cloudflare Workers ä½¿ç”¨è¿™ç§æ ¼å¼æ¥å®šä¹‰å¤„ç†é€»è¾‘ã€‚è¿™ä¸ªå¯¹è±¡å°±æ˜¯ä½ çš„"åº”ç”¨ç¨‹åº"ã€‚', icon: 'ğŸ“¦' }},
            { code: '  async fetch(request, env, ctx) {', type: 'js', explanation: { title: 'fetch å¤„ç†å‡½æ•°', content: 'è¿™æ˜¯ Worker çš„æ ¸å¿ƒå‡½æ•°ï¼Œæ¯æ¬¡æœ‰äººè®¿é—®éƒ½ä¼šæ‰§è¡Œã€‚<br><strong>request</strong>: è¯·æ±‚å¯¹è±¡ï¼ˆåŒ…å« URLã€è¯·æ±‚å¤´ã€IP ç­‰ï¼‰<br><strong>env</strong>: ç¯å¢ƒå˜é‡ï¼ˆåŒ…å«ç»‘å®šçš„æ•°æ®åº“ env.DBï¼‰<br><strong>ctx</strong>: ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆç”¨äºåå°ä»»åŠ¡ï¼‰', icon: 'âš¡' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '    // --- 1. CORS é…ç½® ---', type: 'comment', explanation: { title: 'æ³¨é‡Šï¼šCORS éƒ¨åˆ†', content: 'ä»£ç æ³¨é‡Šï¼Œè¯´æ˜ä¸‹é¢çš„ä»£ç æ˜¯å¤„ç†è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰çš„ã€‚', icon: 'ğŸ“' }},
            { code: '    const corsHeaders = {', type: 'js', explanation: { title: 'CORS å“åº”å¤´å¯¹è±¡', content: 'å®šä¹‰ä¸€ç»„ HTTP å“åº”å¤´ï¼Œå‘Šè¯‰æµè§ˆå™¨"æˆ‘å…è®¸è·¨åŸŸè®¿é—®"ã€‚è¿™æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ã€‚', icon: 'ğŸ›¡ï¸' }},
            { code: '      "Access-Control-Allow-Origin": "*",', type: 'js', explanation: { title: 'å…è®¸çš„æ¥æº', content: '<strong>* (æ˜Ÿå·)</strong>: è¡¨ç¤ºå…è®¸ä»»ä½•åŸŸåè®¿é—®<br>ç”Ÿäº§ç¯å¢ƒå¯æ”¹ä¸ºå…·ä½“åŸŸåå¦‚ "https://mysite.com" æ›´å®‰å…¨', icon: 'ğŸŒ' }},
            { code: '      "Access-Control-Allow-Methods": "GET,HEAD,POST,OPTIONS",', type: 'js', explanation: { title: 'å…è®¸çš„ HTTP æ–¹æ³•', content: 'å‘Šè¯‰æµè§ˆå™¨å¯ä»¥ä½¿ç”¨å“ªäº› HTTP æ–¹æ³•ï¼š<br><strong>GET</strong>: è·å–æ•°æ®<br><strong>POST</strong>: æäº¤æ•°æ®<br><strong>OPTIONS</strong>: é¢„æ£€è¯·æ±‚<br><strong>HEAD</strong>: ç±»ä¼¼ GET ä½†ä¸è¿”å›å†…å®¹', icon: 'ğŸ“‹' }},
            { code: '      "Access-Control-Allow-Headers": "Content-Type",', type: 'js', explanation: { title: 'å…è®¸çš„è¯·æ±‚å¤´', content: 'å…è®¸å‰ç«¯å‘é€ Content-Type è¯·æ±‚å¤´ï¼ˆæŒ‡å®šæ•°æ®æ ¼å¼å¦‚ application/jsonï¼‰ã€‚', icon: 'ğŸ“¨' }},
            { code: '    };', type: 'js', explanation: { title: 'å¯¹è±¡ç»“æŸ', content: 'corsHeaders å¯¹è±¡å®šä¹‰å®Œæ¯•ã€‚', icon: 'âœ…' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '    if (request.method === "OPTIONS") {', type: 'js', explanation: { title: 'å¤„ç†é¢„æ£€è¯·æ±‚', content: '<strong>OPTIONS</strong> æ˜¯æµè§ˆå™¨çš„"é¢„æ£€è¯·æ±‚"<br>åœ¨å‘é€å®é™…è¯·æ±‚å‰ï¼Œæµè§ˆå™¨å…ˆé—®æœåŠ¡å™¨"æˆ‘èƒ½è®¿é—®ä½ å—ï¼Ÿ"<br>è¿™é‡Œç›´æ¥è¿”å›"å¯ä»¥"ï¼ˆå¸¦ CORS å¤´çš„ç©ºå“åº”ï¼‰ã€‚', icon: 'â“' }},
            { code: '      return new Response(null, { headers: corsHeaders });', type: 'js', explanation: { title: 'è¿”å›é¢„æ£€å“åº”', content: '<strong>new Response(null, ...)</strong>: åˆ›å»ºä¸€ä¸ªç©ºå“åº”<br><strong>headers: corsHeaders</strong>: é™„å¸¦ CORS å…è®¸å¤´<br>æµè§ˆå™¨æ”¶åˆ°åçŸ¥é“å¯ä»¥ç»§ç»­å‘é€æ­£å¼è¯·æ±‚ã€‚', icon: 'âœ…' }},
            { code: '    }', type: 'js', explanation: { title: 'if ç»“æŸ', content: 'é¢„æ£€è¯·æ±‚å¤„ç†å®Œæ¯•ï¼Œåé¢æ˜¯æ­£å¼è¯·æ±‚çš„å¤„ç†é€»è¾‘ã€‚', icon: 'âœ…' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '    // --- 2. æ”¶é›†ä¿¡æ¯ ---', type: 'comment', explanation: { title: 'æ³¨é‡Šï¼šæ”¶é›†ä¿¡æ¯', content: 'æ¥ä¸‹æ¥ä»è¯·æ±‚ä¸­æå–è®¿é—®è€…çš„ä¿¡æ¯ã€‚', icon: 'ğŸ“' }},
            { code: '    const country = request.cf?.country || "Unknown";', type: 'js', explanation: { title: 'è·å–å›½å®¶ä»£ç ', content: '<strong>request.cf</strong>: Cloudflare è‡ªåŠ¨æ·»åŠ çš„åœ°ç†ä¿¡æ¯å¯¹è±¡<br><strong>?.</strong>: å¯é€‰é“¾æ“ä½œç¬¦ï¼Œå¦‚æœ cf ä¸å­˜åœ¨ä¸ä¼šæŠ¥é”™<br><strong>|| "Unknown"</strong>: å¦‚æœè·å–ä¸åˆ°ï¼Œé»˜è®¤ä¸º "Unknown"', icon: 'ğŸŒ' }},
            { code: '    const userAgent = request.headers.get("User-Agent") || "Unknown";', type: 'js', explanation: { title: 'è·å–ç”¨æˆ·ä»£ç†', content: '<strong>request.headers</strong>: è¯·æ±‚å¤´å¯¹è±¡<br><strong>.get("User-Agent")</strong>: è·å–æµè§ˆå™¨ä¿¡æ¯<br>User-Agent åŒ…å«æµè§ˆå™¨ç±»å‹ã€ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯ã€‚', icon: 'ğŸ’»' }},
            { code: '    const time = new Date().toISOString();', type: 'js', explanation: { title: 'è·å–å½“å‰æ—¶é—´', content: '<strong>new Date()</strong>: åˆ›å»ºå½“å‰æ—¶é—´å¯¹è±¡<br><strong>.toISOString()</strong>: è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼å¦‚ "2024-01-15T08:30:00.000Z"<br>ISO æ ¼å¼å…¨çƒé€šç”¨ï¼Œæ–¹ä¾¿å­˜å‚¨å’Œæ¯”è¾ƒã€‚', icon: 'ğŸ•' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '    // --- 3. å†™å…¥æ•°æ®åº“ ---', type: 'comment', explanation: { title: 'æ³¨é‡Šï¼šå†™å…¥æ•°æ®åº“', content: 'æ¥ä¸‹æ¥æŠŠè®¿é—®è®°å½•å†™å…¥ D1 æ•°æ®åº“ã€‚', icon: 'ğŸ“' }},
            { code: '    try {', type: 'js', explanation: { title: 'try å—å¼€å§‹', content: 'å°è¯•æ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚å¦‚æœæ•°æ®åº“å‡ºé”™ï¼Œä¼šè¢« catch æ•è·ã€‚', icon: 'ğŸ›¡ï¸' }},
            { code: '      await env.DB.prepare(', type: 'js', explanation: { title: 'å‡†å¤‡ SQL è¯­å¥', content: '<strong>env.DB</strong>: åœ¨ wrangler.toml ä¸­ç»‘å®šçš„ D1 æ•°æ®åº“<br><strong>.prepare()</strong>: å‡†å¤‡ä¸€æ¡ SQL è¯­å¥ï¼ˆä½†è¿˜æ²¡æ‰§è¡Œï¼‰<br><strong>await</strong>: è¿™æ˜¯å¼‚æ­¥æ“ä½œï¼Œéœ€è¦ç­‰å¾…', icon: 'ğŸ“‹' }},
            { code: '        "INSERT INTO Visit_Logs (access_time, country, user_agent) VALUES (?, ?, ?)"', type: 'sql', explanation: { title: 'SQL INSERT è¯­å¥', content: '<strong>INSERT INTO Visit_Logs</strong>: å‘ Visit_Logs è¡¨æ’å…¥æ•°æ®<br><strong>(access_time, country, user_agent)</strong>: æŒ‡å®šè¦å¡«å……çš„åˆ—<br><strong>VALUES (?, ?, ?)</strong>: ä¸‰ä¸ªé—®å·æ˜¯å ä½ç¬¦ï¼Œé˜²æ­¢ SQL æ³¨å…¥ï¼', icon: 'ğŸ’¾' }},
            { code: '      ).bind(time, country, userAgent).run();', type: 'js', explanation: { title: 'ç»‘å®šå‚æ•°å¹¶æ‰§è¡Œ', content: '<strong>.bind(time, country, userAgent)</strong>: æŠŠå˜é‡æŒ‰é¡ºåºå¡«å…¥ ? å ä½ç¬¦<br><strong>.run()</strong>: æ‰§è¡Œè¿™æ¡ SQLï¼ˆå†™å…¥æ•°æ®åº“ï¼‰<br>è¿™ç§æ–¹å¼å«"å‚æ•°åŒ–æŸ¥è¯¢"ï¼Œ100% é˜² SQL æ³¨å…¥ã€‚', icon: 'â–¶ï¸' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '      // --- 4. æŸ¥è¯¢æ€»æ•° ---', type: 'comment', explanation: { title: 'æ³¨é‡Šï¼šæŸ¥è¯¢ç»Ÿè®¡', content: 'å†™å…¥å®Œæˆåï¼ŒæŸ¥è¯¢ä¸€å…±æœ‰å¤šå°‘æ¡è®°å½•ã€‚', icon: 'ğŸ“' }},
            { code: '      const result = await env.DB.prepare(', type: 'js', explanation: { title: 'å‡†å¤‡æŸ¥è¯¢è¯­å¥', content: 'å‡†å¤‡å¦ä¸€æ¡ SQL è¯­å¥æ¥æŸ¥è¯¢ç»Ÿè®¡æ•°æ®ã€‚', icon: 'ğŸ“‹' }},
            { code: '        "SELECT COUNT(*) as total FROM Visit_Logs"', type: 'sql', explanation: { title: 'SQL COUNT æŸ¥è¯¢', content: '<strong>SELECT COUNT(*)</strong>: ç»Ÿè®¡è¡¨ä¸­æ‰€æœ‰è¡Œçš„æ•°é‡<br><strong>as total</strong>: ç»™ç»“æœèµ·åˆ«åå« "total"ï¼Œæ–¹ä¾¿å–å€¼<br><strong>FROM Visit_Logs</strong>: ä» Visit_Logs è¡¨æŸ¥è¯¢', icon: 'ğŸ”¢' }},
            { code: '      ).first();', type: 'js', explanation: { title: 'è·å–ç¬¬ä¸€è¡Œç»“æœ', content: '<strong>.first()</strong>: åªè¿”å›ç»“æœçš„ç¬¬ä¸€è¡Œ<br>å› ä¸º COUNT(*) åªä¼šè¿”å›ä¸€è¡Œï¼ˆå°±æ˜¯é‚£ä¸ªæ•°å­—ï¼‰ï¼Œæ‰€ä»¥ç”¨ first() è€Œä¸æ˜¯ all()ã€‚', icon: '1ï¸âƒ£' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '      const count = result.total;', type: 'js', explanation: { title: 'æå–è®¡æ•°å€¼', content: '<strong>result</strong>: æ˜¯ä¸€ä¸ªå¯¹è±¡ { total: 123 }<br><strong>.total</strong>: å–å‡º total å±æ€§çš„å€¼<br>è¿™ä¸ªå€¼å°±æ˜¯æ•°æ®åº“ä¸­çš„æ€»è®¿é—®é‡ã€‚', icon: 'ğŸ”¢' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '      // --- 5. è¿”å›ç»“æœ ---', type: 'comment', explanation: { title: 'æ³¨é‡Šï¼šè¿”å›å“åº”', content: 'æŠŠç»“æœæ‰“åŒ…æˆ JSON è¿”å›ç»™å‰ç«¯ã€‚', icon: 'ğŸ“' }},
            { code: '      return Response.json(', type: 'js', explanation: { title: 'åˆ›å»º JSON å“åº”', content: '<strong>Response.json()</strong>: Cloudflare æä¾›çš„å¿«æ·æ–¹æ³•<br>è‡ªåŠ¨å°†å¯¹è±¡è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¹¶è®¾ç½®æ­£ç¡®çš„ Content-Type å¤´ã€‚', icon: 'ğŸ“¤' }},
            { code: '        {', type: 'js', explanation: { title: 'å“åº”æ•°æ®å¯¹è±¡', content: 'è¦è¿”å›ç»™å‰ç«¯çš„æ•°æ®å¯¹è±¡ã€‚', icon: 'ğŸ“¦' }},
            { code: '          message: "è®¿é—®è®°å½•æˆåŠŸ",', type: 'js', explanation: { title: 'çŠ¶æ€æ¶ˆæ¯', content: 'å‘Šè¯‰å‰ç«¯æ“ä½œæˆåŠŸäº†ã€‚è™½ç„¶è¿™ä¸ªä¾‹å­æ²¡ç”¨åˆ°ï¼Œä½†æ˜¯æ˜¯ API è®¾è®¡çš„å¥½ä¹ æƒ¯ã€‚', icon: 'âœ…' }},
            { code: '          total_visits: count,', type: 'js', explanation: { title: 'æ€»è®¿é—®é‡', content: 'å‰ç«¯éœ€è¦æ˜¾ç¤ºçš„æ ¸å¿ƒæ•°æ®â€”â€”æ€»è®¿é—®æ¬¡æ•°ã€‚', icon: 'ğŸ”¢' }},
            { code: '          your_info: { country, userAgent }', type: 'js', explanation: { title: 'è®¿å®¢ä¿¡æ¯', content: '<strong>ES6 ç®€å†™è¯­æ³•</strong>: { country } ç­‰åŒäº { country: country }<br>æŠŠç”¨æˆ·çš„å›½å®¶å’Œæµè§ˆå™¨ä¿¡æ¯ä¹Ÿè¿”å›ï¼Œè®©å‰ç«¯æ˜¾ç¤ºã€‚', icon: 'ğŸ“‹' }},
            { code: '        },', type: 'js', explanation: { title: 'æ•°æ®å¯¹è±¡ç»“æŸ', content: 'è¿”å›æ•°æ®å®šä¹‰å®Œæ¯•ã€‚', icon: 'âœ…' }},
            { code: '        { headers: corsHeaders }', type: 'js', explanation: { title: 'é™„åŠ  CORS å¤´', content: '<strong>å…³é”®æ­¥éª¤ï¼</strong>å¿…é¡»æŠŠ CORS å¤´é™„åŠ åˆ°å“åº”ä¸Šï¼Œå¦åˆ™æµè§ˆå™¨ä¼šæ‹’ç»è¯»å–æ•°æ®ã€‚å¾ˆå¤šäººå¿˜è®°è¿™æ­¥å¯¼è‡´è°ƒè¯•åŠå¤©ã€‚', icon: 'ğŸ”‘' }},
            { code: '      );', type: 'js', explanation: { title: 'Response.json ç»“æŸ', content: 'JSON å“åº”åˆ›å»ºå®Œæˆå¹¶è¿”å›ã€‚', icon: 'âœ…' }},
            { code: '', type: 'empty', explanation: { title: 'ç©ºè¡Œ', content: '', icon: '' }},
            { code: '    } catch (e) {', type: 'js', explanation: { title: 'catch é”™è¯¯æ•è·', content: 'å¦‚æœä¸Šé¢çš„æ•°æ®åº“æ“ä½œå¤±è´¥ï¼ˆå¦‚è¡¨ä¸å­˜åœ¨ã€è¯­æ³•é”™è¯¯ï¼‰ï¼Œç¨‹åºä¼šè·³åˆ°è¿™é‡Œã€‚<br><strong>e</strong> å˜é‡åŒ…å«é”™è¯¯ä¿¡æ¯ã€‚', icon: 'ğŸš¨' }},
            { code: '      return new Response(e.message, { status: 500, headers: corsHeaders });', type: 'js', explanation: { title: 'è¿”å›é”™è¯¯å“åº”', content: '<strong>e.message</strong>: é”™è¯¯çš„æè¿°æ–‡å­—<br><strong>status: 500</strong>: HTTP çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å†…éƒ¨é”™è¯¯<br><strong>headers: corsHeaders</strong>: å³ä½¿å‡ºé”™ä¹Ÿè¦å¸¦ CORS å¤´ï¼å¦åˆ™å‰ç«¯åªä¼šçœ‹åˆ°"ç½‘ç»œé”™è¯¯"è€ŒéçœŸå®é”™è¯¯åŸå› ã€‚', icon: 'âš ï¸' }},
            { code: '    }', type: 'js', explanation: { title: 'try-catch ç»“æŸ', content: 'é”™è¯¯å¤„ç†å—ç»“æŸã€‚', icon: 'âœ…' }},
            { code: '  },', type: 'js', explanation: { title: 'fetch å‡½æ•°ç»“æŸ', content: 'fetch å¤„ç†å‡½æ•°å®šä¹‰å®Œæ¯•ã€‚', icon: 'âœ…' }},
            { code: '};', type: 'js', explanation: { title: 'æ¨¡å—å¯¼å‡ºç»“æŸ', content: 'æ•´ä¸ª Worker æ¨¡å—å®šä¹‰å®Œæˆã€‚å½“æœ‰è¯·æ±‚æ¥æ—¶ï¼ŒCloudflare ä¼šè°ƒç”¨è¿™ä¸ªæ¨¡å—çš„ fetch å‡½æ•°ã€‚', icon: 'ğŸ' }},
        ];

        // ==================== æ¸²æŸ“ä»£ç  ====================
        function renderCode(containerId, lines, explanationId) {
            const container = document.getElementById(containerId);
            container.innerHTML = lines.map((line, index) => {
                const typeColors = {
                    'html': 'text-orange-400',
                    'css': 'text-pink-400',
                    'js': 'text-yellow-400',
                    'sql': 'text-green-400',
                    'comment': 'text-gray-500',
                    'empty': 'text-gray-600'
                };
                const colorClass = typeColors[line.type] || 'text-gray-300';
                const displayCode = line.code || ' ';
                return `<div class="code-line px-2 py-0.5 font-mono ${colorClass}" data-index="${index}" onclick="showExplanation('${containerId}', ${index}, '${explanationId}')">
                    <span class="text-gray-600 select-none mr-4">${String(index + 1).padStart(2, '0')}</span>${escapeHtml(displayCode)}
                </div>`;
            }).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showExplanation(containerId, index, explanationId) {
            const lines = containerId === 'frontend-code' ? frontendLines : backendLines;
            const line = lines[index];

            // ç§»é™¤ä¹‹å‰çš„é«˜äº®
            document.querySelectorAll(`#${containerId} .code-line`).forEach(el => el.classList.remove('active'));
            // æ·»åŠ æ–°é«˜äº®
            document.querySelector(`#${containerId} .code-line[data-index="${index}"]`).classList.add('active');

            const expContainer = document.getElementById(explanationId);
            if (line.explanation && line.explanation.title) {
                expContainer.innerHTML = `
                    <div class="mb-4">
                        <span class="text-4xl">${line.explanation.icon}</span>
                    </div>
                    <h3 class="text-xl font-bold mb-4 text-gray-800">${line.explanation.title}</h3>
                    <div class="bg-white rounded-lg p-4 mb-4 shadow-sm">
                        <code class="text-sm text-purple-600 font-mono">${escapeHtml(line.code)}</code>
                    </div>
                    <p class="text-gray-600 leading-relaxed">${line.explanation.content}</p>
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <span class="text-xs px-2 py-1 rounded bg-gray-200 text-gray-600">ç¬¬ ${index + 1} è¡Œ</span>
                        <span class="text-xs px-2 py-1 rounded ml-2 ${
                            line.type === 'html' ? 'bg-orange-100 text-orange-700' :
                            line.type === 'css' ? 'bg-pink-100 text-pink-700' :
                            line.type === 'js' ? 'bg-yellow-100 text-yellow-700' :
                            line.type === 'sql' ? 'bg-green-100 text-green-700' :
                            'bg-gray-100 text-gray-700'
                        }">${line.type.toUpperCase()}</span>
                    </div>
                `;
            }
        }

        // ==================== æ•°æ®æµåŠ¨åŠ¨ç”» ====================
        let flowStep = 0;
        let flowInterval = null;

        const flowDescriptions = [
            "ğŸ§‘ ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä½ çš„ç½‘é¡µ...",
            "ğŸ“¤ é¡µé¢åŠ è½½å®Œæˆï¼ŒJavaScript è°ƒç”¨ fetch() å‘ Worker å‘é€è¯·æ±‚...",
            "âš¡ Worker æ¥æ”¶è¯·æ±‚ï¼Œæ£€æŸ¥ CORSï¼Œæ”¶é›†ç”¨æˆ·çš„å›½å®¶å’Œæµè§ˆå™¨ä¿¡æ¯...",
            "ğŸ’¾ Worker æ‰§è¡Œ INSERT è¯­å¥ï¼Œå°†è®¿é—®è®°å½•å†™å…¥ D1 æ•°æ®åº“...",
            "ğŸ” Worker æ‰§è¡Œ SELECT COUNT(*) æŸ¥è¯¢ï¼Œç»Ÿè®¡æ€»è®¿é—®é‡...",
            "ğŸ“¥ Worker å°†ç»“æœæ‰“åŒ…æˆ JSONï¼Œé™„ä¸Š CORS å¤´è¿”å›ç»™å‰ç«¯...",
            "âœ¨ å‰ç«¯æ”¶åˆ°æ•°æ®ï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤ºè®¿é—®é‡å’Œç”¨æˆ·ä¿¡æ¯ï¼"
        ];

        function startFlow() {
            resetFlow();
            flowStep = 0;
            flowInterval = setInterval(() => {
                if (flowStep >= 7) {
                    clearInterval(flowInterval);
                    return;
                }
                document.getElementById(`flow-${flowStep + 1}`).classList.add('active');
                document.getElementById('flow-description').innerHTML = flowDescriptions[flowStep];
                flowStep++;
            }, 1500);
        }

        function resetFlow() {
            if (flowInterval) clearInterval(flowInterval);
            flowStep = 0;
            for (let i = 1; i <= 7; i++) {
                document.getElementById(`flow-${i}`).classList.remove('active');
            }
            document.getElementById('flow-description').innerHTML = 'ç‚¹å‡»"å¼€å§‹æ¼”ç¤º"è§‚å¯Ÿæ•°æ®æµåŠ¨è¿‡ç¨‹';
        }

        // ==================== æ¦‚å¿µå±•å¼€/æ”¶èµ· ====================
        function toggleConcept(id) {
            const content = document.getElementById(`${id}-content`);
            const arrow = document.getElementById(`${id}-arrow`);

            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                arrow.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        // ==================== æµ‹éªŒç³»ç»Ÿ ====================
        const quizQuestions = [
            {
                question: "CORS çš„å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿå®ƒè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ",
                options: [
                    "Cross-Origin Resource Sharingï¼Œè§£å†³è·¨åŸŸè®¿é—®é—®é¢˜",
                    "Content Origin Resource Systemï¼Œè§£å†³å†…å®¹åˆ†å‘é—®é¢˜",
                    "Central Operation Request Serviceï¼Œè§£å†³è¯·æ±‚ç®¡ç†é—®é¢˜",
                    "Cross Object Reference Standardï¼Œè§£å†³å¯¹è±¡å¼•ç”¨é—®é¢˜"
                ],
                correct: 0,
                explanation: "CORS (Cross-Origin Resource Sharing) è·¨åŸŸèµ„æºå…±äº«ï¼Œå…è®¸æµè§ˆå™¨å‘ä¸åŒæºçš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚"
            },
            {
                question: "ä¸ºä»€ä¹ˆä½¿ç”¨ VALUES (?, ?, ?) è€Œä¸æ˜¯ç›´æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ",
                options: [
                    "ä¸ºäº†è®©ä»£ç çœ‹èµ·æ¥æ›´ç®€æ´",
                    "ä¸ºäº†é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»",
                    "ä¸ºäº†æé«˜æ•°æ®åº“æŸ¥è¯¢é€Ÿåº¦",
                    "è¿™åªæ˜¯ä¸€ç§ä»£ç é£æ ¼åå¥½"
                ],
                correct: 1,
                explanation: "ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ (?) å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»ã€‚æ•°æ®åº“ä¼šè‡ªåŠ¨å°†å‚æ•°å½“ä½œçº¯æ–‡æœ¬å¤„ç†ã€‚"
            },
            {
                question: "async/await çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ",
                options: [
                    "è®©ä»£ç è¿è¡Œå¾—æ›´å¿«",
                    "å¤„ç†å¼‚æ­¥æ“ä½œï¼Œè®©ä»£ç æ›´æ˜“è¯»",
                    "åŠ å¯†ä¼ è¾“çš„æ•°æ®",
                    "å‡å°‘ä»£ç çš„è¡Œæ•°"
                ],
                correct: 1,
                explanation: "async/await è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ï¼Œæ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚"
            },
            {
                question: "request.cf æ˜¯ä»€ä¹ˆï¼Ÿç”±è°æä¾›ï¼Ÿ",
                options: [
                    "ç”¨æˆ·æ‰‹åŠ¨å¡«å†™çš„è¡¨å•æ•°æ®",
                    "å‰ç«¯ JavaScript åˆ›å»ºçš„å¯¹è±¡",
                    "Cloudflare è‡ªåŠ¨æ·»åŠ çš„åœ°ç†ä½ç½®ä¿¡æ¯",
                    "æ•°æ®åº“è¿”å›çš„æŸ¥è¯¢ç»“æœ"
                ],
                correct: 2,
                explanation: "request.cf æ˜¯ Cloudflare è¾¹ç¼˜ç½‘ç»œè‡ªåŠ¨é™„åŠ çš„å¯¹è±¡ï¼ŒåŒ…å«ç”¨æˆ·çš„åœ°ç†ä½ç½®ã€æ—¶åŒºç­‰ä¿¡æ¯ã€‚"
            },
            {
                question: "ä¸ºä»€ä¹ˆ catch å—ä¸­ä¹Ÿè¦é™„å¸¦ corsHeadersï¼Ÿ",
                options: [
                    "è¿™åªæ˜¯ä»£ç é£æ ¼ï¼Œä¸æ˜¯å¿…éœ€çš„",
                    "è®©é”™è¯¯ä¿¡æ¯çœ‹èµ·æ¥æ›´ç¾è§‚",
                    "å¦åˆ™å‰ç«¯ä¼šçœ‹åˆ° CORS é”™è¯¯è€ŒéçœŸå®é”™è¯¯",
                    "ä¸ºäº†åŠ å¿«é”™è¯¯å“åº”é€Ÿåº¦"
                ],
                correct: 2,
                explanation: "å¦‚æœé”™è¯¯å“åº”ä¸å¸¦ CORS å¤´ï¼Œæµè§ˆå™¨ä¼šæ‹¦æˆªå“åº”ï¼Œå‰ç«¯åªä¼šçœ‹åˆ°"ç½‘ç»œé”™è¯¯"è€Œæ— æ³•è·å–çœŸæ­£çš„é”™è¯¯ä¿¡æ¯ã€‚"
            },
            {
                question: "document.getElementById('count-display').innerText = data.total_visits è¿™è¡Œä»£ç åšäº†ä»€ä¹ˆï¼Ÿ",
                options: [
                    "å‘æœåŠ¡å™¨å‘é€è®¿é—®é‡æ•°æ®",
                    "ä»æœåŠ¡å™¨è·å– count-display çš„å€¼",
                    "å°†åç«¯è¿”å›çš„è®¿é—®é‡æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š",
                    "åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°è®°å½•"
                ],
                correct: 2,
                explanation: "è¿™è¡Œä»£ç æ‰¾åˆ° ID ä¸º count-display çš„ HTML å…ƒç´ ï¼Œå¹¶å°†å…¶æ–‡æœ¬å†…å®¹è®¾ç½®ä¸ºåç«¯è¿”å›çš„è®¿é—®é‡ã€‚"
            }
        ];

        let currentQuestion = 0;
        let score = 0;

        function renderQuestion() {
            const q = quizQuestions[currentQuestion];
            document.getElementById('quiz-question').textContent = `${currentQuestion + 1}. ${q.question}`;
            document.getElementById('quiz-options').innerHTML = q.options.map((opt, i) => `
                <button onclick="checkAnswer(${i})" class="quiz-option w-full text-left p-4 bg-white/20 hover:bg-white/30 rounded-lg transition">
                    <span class="font-bold mr-2">${String.fromCharCode(65 + i)}.</span> ${opt}
                </button>
            `).join('');
            document.getElementById('quiz-progress').textContent = `${currentQuestion + 1} / ${quizQuestions.length}`;
            document.getElementById('quiz-feedback').classList.add('hidden');
            document.getElementById('quiz-next').classList.add('hidden');
        }

        function checkAnswer(selected) {
            const q = quizQuestions[currentQuestion];
            const feedback = document.getElementById('quiz-feedback');
            const options = document.querySelectorAll('.quiz-option');

            options.forEach((opt, i) => {
                opt.disabled = true;
                if (i === q.correct) {
                    opt.classList.add('bg-green-500/50');
                } else if (i === selected && selected !== q.correct) {
                    opt.classList.add('bg-red-500/50');
                }
            });

            if (selected === q.correct) {
                score++;
                feedback.innerHTML = `<div class="text-green-200">âœ… æ­£ç¡®ï¼${q.explanation}</div>`;
                feedback.className = 'mt-6 p-4 rounded-lg bg-green-500/30';
            } else {
                feedback.innerHTML = `<div class="text-red-200">âŒ é”™è¯¯ã€‚${q.explanation}</div>`;
                feedback.className = 'mt-6 p-4 rounded-lg bg-red-500/30';
            }
            feedback.classList.remove('hidden');

            if (currentQuestion < quizQuestions.length - 1) {
                document.getElementById('quiz-next').classList.remove('hidden');
            } else {
                setTimeout(showResult, 1500);
            }
        }

        function nextQuestion() {
            currentQuestion++;
            renderQuestion();
        }

        function showResult() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-result').classList.remove('hidden');
            const percentage = Math.round((score / quizQuestions.length) * 100);
            let message = '';
            if (percentage === 100) message = 'ğŸ‰ å®Œç¾ï¼ä½ å·²ç»å®Œå…¨æŒæ¡äº†ï¼';
            else if (percentage >= 80) message = 'ğŸ‘ å¾ˆæ£’ï¼åŸºæœ¬æ¦‚å¿µéƒ½ç†è§£äº†ï¼';
            else if (percentage >= 60) message = 'ğŸ‘ ä¸é”™ï¼Œå†å¤ä¹ ä¸€ä¸‹å°±æ›´å¥½äº†ï¼';
            else message = 'ğŸ“š å»ºè®®å†å›é¡¾ä¸€ä¸‹æ•™ç¨‹å†…å®¹å“¦ï¼';
            document.getElementById('quiz-score').innerHTML = `ä½ ç­”å¯¹äº† ${score} / ${quizQuestions.length} é¢˜ (${percentage}%)<br><span class="text-lg">${message}</span>`;
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('quiz-result').classList.add('hidden');
            renderQuestion();
        }

        // ==================== åˆå§‹åŒ– ====================
        document.addEventListener('DOMContentLoaded', function() {
            renderCode('frontend-code', frontendLines, 'frontend-explanation');
            renderCode('backend-code', backendLines, 'backend-explanation');
            renderQuestion();
        });
    </script>
</body>
</html>
