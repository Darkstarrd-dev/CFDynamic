<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WinWeb æ•°æ®åº“(D1) åˆ›å»ºè¯¦è§£</title>
    <style>
        :root {
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --primary: #10b981; /* D1 Green */
            --secondary: #3b82f6;
            --warning: #f59e0b;
            --danger: #ef4444;
            --terminal-bg: #1e293b;
            --text-main: #334155;
            --code-text: #e2e8f0;
        }
        body { font-family: 'Segoe UI', system-ui, sans-serif; line-height: 1.6; background: var(--bg-color); color: var(--text-main); margin: 0; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; }

        h1 { text-align: center; color: #0f172a; margin-bottom: 10px; }
        h2 {
            border-left: 5px solid var(--primary);
            padding-left: 15px;
            margin-top: 50px;
            color: #1e293b;
            background: #e2e8f0;
            padding: 12px 15px;
            border-radius: 0 8px 8px 0;
        }

        /* ç»ˆç«¯æ¨¡æ‹Ÿå™¨ */
        .terminal-window {
            background: var(--terminal-bg);
            color: var(--code-text);
            border-radius: 8px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
        }
        .terminal-header { background: #334155; padding: 8px 15px; display: flex; gap: 6px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; }
        .dot.red { background: #ef4444; }
        .dot.yellow { background: #f59e0b; }
        .dot.green { background: #10b981; }
        .terminal-body { padding: 20px; white-space: pre-wrap; }

        .cmd { color: #fff; font-weight: bold; }
        .prompt { color: #10b981; }
        .output { color: #cbd5e1; }
        .highlight { color: #facc15; font-weight: bold; }
        .id-highlight { color: #a78bfa; font-weight: bold; border-bottom: 1px dashed #a78bfa; }

        /* æ¦‚å¿µå¡ç‰‡ */
        .concept-card {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-top: 4px solid var(--primary);
        }

        /* Q&A */
        .qa-box { background: #f0fdf4; border: 1px solid #bbf7d0; padding: 15px; border-radius: 6px; margin-top: 15px; }
        .qa-title { color: #166534; font-weight: bold; margin-bottom: 5px; }

        pre { background: #1e293b; color: var(--code-text); padding: 15px; border-radius: 8px; overflow-x: auto; }
    </style>
</head>
<body>

<div class="container">
    <h1>WinWeb D1 æ•°æ®åº“åˆ›å»ºè¯¦è§£</h1>
    <p style="text-align: center; color: #64748b;">å‘½ä»¤è¡Œäº¤äº’ Â· å”¯ä¸€IDè§£è¯» Â· ç»‘å®šé…ç½® Â· è®¿é—®åŸç†</p>

    <!-- 1. æ‰§è¡Œå‘½ä»¤ä¸åé¦ˆ -->
    <h2>1. å‘½ä»¤è¡Œå®æˆ˜ï¼šåˆ›å»ºæ•°æ®åº“</h2>
    <p>è¯·åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼ˆå’Œ <code>backend</code> æ–‡ä»¶å¤¹åŒçº§çš„ä½ç½®ï¼‰è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¿™é‡Œæˆ‘ä»¬æŠŠæ•°æ®åº“å‘½åä¸º <code>winweb-db</code>ã€‚</p>

    <div class="terminal-window">
        <div class="terminal-header"><div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div></div>
        <div class="terminal-body">
<span class="prompt">user@project:~$</span> <span class="cmd">npx wrangler d1 create winweb-db</span>

<span class="output">âœ… Successfully created DB 'winweb-db' in region APAC</span>

<span class="output">Created your new D1 database!</span>
<span class="output">[[d1_databases]]</span>
<span class="output">binding = "DB"</span>
<span class="output">database_name = "winweb-db"</span>
<span class="output">database_id = "<span class="id-highlight">e2e4a1b2-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span>"</span>

<span class="output">To configure your Worker, add the above config to your wrangler.toml</span>
        </div>
    </div>

    <div class="concept-card">
        <h3>ğŸ” æ·±åº¦è§£ç ï¼šå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
        <ul>
            <li><strong>äº‘ç«¯æ³¨å†Œï¼š</strong> å‘½ä»¤å‘é€ç¬é—´ï¼ŒCloudflare åœ¨å®ƒçš„æœåŠ¡å™¨ä¸Šä¸ºä½ å¼€è¾Ÿäº†ä¸€ä¸ªä¸“å±çš„ SQLite æ•°æ®åº“ç©ºé—´ã€‚</li>
            <li><strong>winweb-dbï¼š</strong> è¿™åªæ˜¯ä½ ç»™äººçœ‹çš„â€œæ˜µç§°â€ï¼Œæ–¹ä¾¿ä½ è®°ã€‚</li>
            <li><strong>database_id (æœ€é‡è¦)ï¼š</strong> çœ‹åˆ°é‚£ä¸ªé•¿é•¿çš„ UUID äº†å—ï¼Ÿ<br>è¿™æ˜¯æ•°æ®åº“çš„<strong>å”¯ä¸€çœŸå®èº«ä»½</strong>ã€‚æ— è®ºä½ ä»¥åç»™å®ƒæ”¹ä»€ä¹ˆåï¼Œè¿™ä¸ª ID æ°¸è¿œä¸å˜ã€‚Worker å¿…é¡»é è¿™ä¸ª ID æ‰èƒ½æ‰¾åˆ°å®ƒã€‚</li>
        </ul>
    </div>

    <!-- 2. å…³é”®é…ç½® -->
    <h2>2. æ¡¥æ¢æ­å»ºï¼šé…ç½® wrangler.jsonc</h2>
    <p>åˆ›å»ºå®Œæ•°æ®åº“åï¼Œå®ƒç°åœ¨å­¤é›¶é›¶åœ°é£˜åœ¨äº‘ç«¯ã€‚ä½ å¿…é¡»ä¿®æ”¹ Worker çš„é…ç½®æ–‡ä»¶ï¼ŒæŠŠå®ƒâ€œæŒ‚è½½â€åˆ° Worker ä¸Šã€‚</p>

    <p>æ‰“å¼€ <code>backend/wrangler.jsonc</code>ï¼ŒæŠŠç»ˆç«¯é‡Œåç»™ä½ çš„é‚£å‡ è¡Œå¤åˆ¶è¿›å»ï¼ˆæ³¨æ„ JSONC æ ¼å¼ï¼‰ï¼š</p>

    <pre><code class="language-json">{
  "name": "winweb-stats",
  "main": "src/index.js",
  "compatibility_date": "2025-02-19",

  <span class="highlight">// â–¼ æŠŠè¿™ä¸€æ®µåŠ è¿›å» â–¼</span>
  "d1_databases": [
    {
      "binding": "DB",  <span class="comment">// ä»£ç é‡Œç”¨ env.DB è°ƒç”¨å®ƒ</span>
      "database_name": "winweb-db",
      "database_id": "<span class="id-highlight">e2e4a1b2-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span>" <span class="comment">// åˆšæ‰ç”Ÿæˆçš„é‚£ä¸ªé•¿ID</span>
    }
  ]
}</code></pre>

    <!-- 3. æ ¸å¿ƒç–‘é—®è§£ç­” -->
    <h2>3. æ ¸å¿ƒæ¦‚å¿µæ‰«ç›²ï¼šåœ°å€ä¸è®¿é—®</h2>

    <div class="qa-box">
        <div class="qa-title">Q: è¿™ä¸ªæ•°æ®åº“æœ‰è®¿é—®åœ°å€å—ï¼Ÿï¼ˆæ¯”å¦‚ https://db.cloudf...ï¼‰</div>
        <p><strong>A: ç»å¯¹æ²¡æœ‰ï¼è¿™ä¹Ÿæ˜¯å®ƒå®‰å…¨çš„æ ¹æœ¬åŸå› ã€‚</strong></p>
        <p>D1 æ•°æ®åº“ä¸åƒ Worker é‚£æ ·æœ‰å…¬ç½‘ URLã€‚å®ƒæ˜¯ä¸€ä¸ª<strong>å†…éƒ¨èµ„æº</strong>ã€‚
        <br><strong>è®¿é—®è·¯å¾„æ˜¯è¿™æ ·çš„ï¼š</strong>
        <br>ç”¨æˆ·çš„æµè§ˆå™¨ â” (å…¬ç½‘ HTTPS) â” <strong>ä½ çš„ Worker</strong> â” (å†…éƒ¨ä¸“ç”¨é€šé“) â” <strong>D1 æ•°æ®åº“</strong></p>
        <p>å¤–ç•Œåªæœ‰æ‹¥æœ‰æƒé™çš„ Worker æ‰èƒ½æ‘¸åˆ°æ•°æ®åº“ï¼Œé»‘å®¢æ— æ³•ç›´æ¥ä»å¤–éƒ¨æ”»å‡»æ•°æ®åº“ç«¯å£ã€‚</p>
    </div>

    <div class="qa-box" style="border-color:#cbd5e1; background:#f8fafc;">
        <div class="qa-title" style="color:#334155;">Q: æ•°æ®åº“åˆ›å»ºå¥½äº†ï¼Œé‡Œé¢æ˜¯ç©ºçš„å—ï¼Ÿ</div>
        <p><strong>A: æ˜¯çš„ï¼Œå®ƒæ˜¯å®Œå…¨ç©ºçš„ã€‚</strong></p>
        <p>å°±åƒä½ ä¹°äº†ä¸€ä¸ªæ–°æœ¬å­ï¼Œé‡Œé¢ä¸€å¼ çº¸éƒ½æ²¡å†™ã€‚ä½ ç°åœ¨è¿˜ä¸èƒ½å­˜æ•°æ®ã€‚
        <br><strong>ä¸‹ä¸€æ­¥åŠ¨ä½œï¼š</strong> ä½ éœ€è¦æ‰§è¡Œ SQL è¯­å¥æ¥åˆ›å»ºâ€œè¡¨æ ¼â€ï¼ˆTableï¼‰ã€‚</p>
    </div>

    <!-- 4. åˆå§‹åŒ–è¡¨æ ¼ (ä¸‹ä¸€æ­¥é¢„å‘Š) -->
    <h2>4. è¶çƒ­æ‰“é“ï¼šåˆå§‹åŒ–è¡¨æ ¼</h2>
    <p>æ—¢ç„¶å»ºç«‹äº†åº“ï¼Œæˆ‘ä»¬é¡ºæ‰‹æŠŠè¡¨ä¹Ÿå»ºäº†å§ã€‚è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ <code>schema.sql</code>ï¼š</p>

    <pre><code class="language-sql">-- schema.sql
CREATE TABLE IF NOT EXISTS analytics (
    app_id TEXT PRIMARY KEY,
    hits INTEGER DEFAULT 0
);</code></pre>

    <p>ç„¶åè¿è¡Œè¿™ä¸ªå‘½ä»¤æŠŠè¡¨å†™å…¥æ•°æ®åº“ï¼š</p>
    <div class="terminal-window">
        <div class="terminal-body">
<span class="prompt">user@project:~$</span> <span class="cmd">npx wrangler d1 execute winweb-db --remote --file=./schema.sql</span>

<span class="output">ğŸŒ€ Executing on winweb-db (e2e4a1b2-...)</span>
<span class="output">âœ… 1 queries executed</span>
        </div>
    </div>
    <p style="font-size: 0.9rem; color: #64748b;">æ³¨ï¼šåŠ ä¸Š <code>--remote</code> æ˜¯å‘Šè¯‰å®ƒæ“ä½œäº‘ç«¯çš„çœŸå®æ•°æ®åº“ã€‚å¦‚æœä¸åŠ æˆ–åŠ  <code>--local</code>ï¼Œå®ƒåªä¼šæ“ä½œä½ ç”µè„‘æœ¬åœ°çš„æµ‹è¯•åº“ã€‚</p>

</div>

</body>
</html>
